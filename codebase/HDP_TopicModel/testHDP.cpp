/*###############################################################
## MODULE: testHDP.cpp
## VERSION: 1.0 
## SINCE 2014-07-26
## AUTHOR Jimmy Lin (xl5224) - JimmyLin@utexas.edu  
## DESCRIPTION: 
##      
#################################################################
## Edited by MacVim
## Class Info auto-generated by Snippet 
################################################################*/

#include "HDP.h" 

#define PASS "PASS"
#define FAIL "FAIL"
#define RESULT(x) x?PASS:FAIL

bool test_vocabulary_read () {
    bool success = false;
    string fname = "voc.txt";
    vector<string>* vocabularies = new vector<string> ();
    voc_list_read (fname, vocabularies);
    if ( vocabularies->size() == 4 &&
         !(*vocabularies)[0].compare("AAA") &&
         !(*vocabularies)[1].compare("BBB") &&
         !(*vocabularies)[2].compare("CCC") &&
         !(*vocabularies)[3].compare("DDD") )
        success = true;
    delete vocabularies;
    return success; 
}

bool test_string_split () {
    bool success = false;
    string test_string = "abc:132 bcd:ef fg:he li:ne";
    vector<string> elements;
    split (test_string, &elements, " ");
    if (elements.size() == 4 &&
        !(elements)[0].compare("abc:132") &&
        !(elements)[1].compare("bcd:ef") &&
        !(elements)[2].compare("fg:he") &&
        !(elements)[3].compare("li:ne") )
        success = true;

    if (!success) {
        cout << elements.size() << endl;
        for (int i = 0; i < elements.size(); i ++) {
            cout << (elements)[i] << endl;
        }
    }
    return success;
}

void test_document_list_read (bool& success_voc, bool& success_word, bool& success_doc) {
    success_voc = false; success_word = false; success_doc = false;
    string fname = "doc.txt";

    vector< pair<int,int> > doc_lookup;
    vector<int> word_lookup;
    vector< vector<int> > voc_lookup (4, vector<int> ());
    Lookups lookup_tables;
    lookup_tables.doc_lookup = &doc_lookup;
    lookup_tables.word_lookup = &word_lookup;
    lookup_tables.voc_lookup = &voc_lookup;
    document_list_read (fname, &lookup_tables);
    
    // check doc_lookup table
    if ( voc_lookup.size() == 4 &&
         voc_lookup[0][0] == 0 &&  voc_lookup[0][1] == 4 &&
         voc_lookup[1][0] == 2 &&  voc_lookup[2][0] == 1 &&
         voc_lookup[3][0] == 3 &&  voc_lookup[3][1] == 5 )
        success_voc = true;

    if ( word_lookup.size() == 6 &&
         word_lookup[0] == 1 &&  word_lookup[1] == 3 &&
         word_lookup[2] == 2 &&  word_lookup[3] == 4 &&
         word_lookup[4] == 1 &&  word_lookup[5] == 4 )
        success_word = true;

    if ( doc_lookup.size() == 3 &&
        doc_lookup[0].first == 0 && doc_lookup[0].second == 2 &&
        doc_lookup[1].first == 2 && doc_lookup[1].second == 4 &&
        doc_lookup[2].first == 4 && doc_lookup[2].second == 6 )
        success_doc = true;
    if (!success_doc) {
        cout << doc_lookup.size() << endl;
        cout << doc_lookup[0].first << "," << doc_lookup[0].second << endl;
        cout << doc_lookup[1].first << "," << doc_lookup[1].second << endl;
        cout << doc_lookup[2].first << "," << doc_lookup[2].second << endl;
    }
}

int main (int args, char ** argv) {

    string result_vocabulary_read = RESULT(test_vocabulary_read());
    string result_string_split = RESULT(test_string_split());

    bool success_voc_lookup, success_word_lookup, success_doc_lookup;
    test_document_list_read (success_voc_lookup, success_word_lookup, success_doc_lookup);
    string result_doc_lookup = RESULT(success_doc_lookup);
    string result_word_lookup = RESULT(success_word_lookup);
    string result_voc_lookup = RESULT(success_voc_lookup);

    cout << "Test Cases:" << endl;
    cout << "  test_vocabulary_read: " << result_vocabulary_read << endl;
    cout << "  test_string_split: " << result_string_split << endl;
    cout << "  test_doc_lookup: " << result_doc_lookup<< endl;
    cout << "  test_word_lookup: " << result_word_lookup<< endl;
    cout << "  test_voc_lookup: " << result_voc_lookup<< endl;

    return 0;
}
